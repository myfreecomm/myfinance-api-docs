<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Docs</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="javascripts/all.js" type="text/javascript"></script>

      <script>
        $(function() {
          setupLanguages(["json","xml"]);
        });
      </script>
  </head>

  <body class="index">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="json">json</a>
              <a href="#" data-language-name="xml">xml</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='https://app.myfinance.com.br'>Acessar o Myfinance</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="introdu„ß„£o">Introdu√ß√£o</h1>

<p>O MyFinance possui uma API REST para interagir com seus recursos atrav√©s de XML ou JSON sobre HTTPS.</p>

<p>Cada recurso possui sua pr√≥pria URI e pode ser manipulado de maneira isolada, tentando assim seguir os princ√≠pios REST ao m√°ximo, utilizando os principais verbos HTTP de forma sem√¢ntica (GET, POST, PUT, DELETE).</p>

          <h2 id="uso-geral">Uso Geral</h2>

<p>Por padr√£o, a API deve ser acessada atrav√©s das mesmas URLs e verbos HTTP da interface HTML normal, adicionando-se o formato desejado (.xml ou .json) ao final da URL, ou ent√£o passando os headers Content-type e Accept na requisi√ß√£o HTTP com os valores de acordo com o formato desejando (application/xml ou application/json, respectivamente).</p>

          <h2 id="suspens„£o-do-acesso">Suspens√£o do acesso</h2>

<blockquote>
<p>Exemplo de resposta com erro</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Conta bloqueada por falta de pagamento. Entre em contato conosco via suporte@myfinance.com.br"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<pre class="highlight xml"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;errors&gt;</span>
  <span class="nt">&lt;error&gt;</span>Conta bloqueada por falta de pagamento. Entre em contato conosco via suporte@myfinance.com.br<span class="nt">&lt;/error&gt;</span>
<span class="nt">&lt;/errors&gt;</span>
</code></pre>

<p>Caso o sistema n√£o localize o √∫ltimo pagamento de mensalidade, o acesso √† API ser√° bloqueado ap√≥s 10 dias a contar da data de vencimento.</p>

<aside class="notice">
Nenhum dado da conta ser√° apagado, apenas o acesso ser√° suspenso at√© a identifica√ß√£o do pagamento. O usu√°rio dever√° entrar em contato com o suporte para regularizar sua situa√ß√£o.
</aside>

<p>Caso o acesso √† API seja efetuado neste per√≠odo (10 dias ap√≥s o vencimento da mensalidade), o sistema retornar√° uma mensagem de erro <code class="prettyprint">402: Payment Required</code>.</p>

          <h2 id="compress„£o-gzip">Compress√£o gzip</h2>

<blockquote>
<p>Exemplo de utiliza√ß√£o da compress√£o <code class="prettyprint">gzip</code></p>
</blockquote>
<pre class="highlight shell"><code><span class="gp">$ </span>curl -u 7ezUPAqq8T1ny0w1bSXr <span class="se">\</span>
       -H <span class="s1">'Accept: application/json'</span> <span class="se">\</span>
       -H <span class="s1">'Content-type: application/json'</span> <span class="se">\</span>
       -H <span class="s1">'Accept-Encoding: gzip'</span> <span class="se">\</span>
       -X GET https://app.myfinance.com.br/entities/2593/attachments/25940
</code></pre>

<p>A compress√£o gzip √© considerada sem perda de dados. As vantagens de utiliz√°-la s√£o o menor uso da largura de banda e a maior velocidade na resposta.</p>

<p>Para utilizar o recurso da compress√£o gzip nas requisi√ß√µes, basta adicionar o header <code class="prettyprint">Accept-Encoding</code> com o valor <code class="prettyprint">gzip</code>.</p>

<p>Caso a resposta esteja comprimida, ela conter√° um header <code class="prettyprint">Content-Encoding</code> com o valor <code class="prettyprint">gzip</code>.</p>

<p>Em alguns casos, mesmo que o servidor mande uma resposta comprimida, a requisi√ß√£o pode vir sem compress√£o, pois pode existir algum proxy no caminho da resposta que realize a descompress√£o dos dados (podendo ou n√£o remover o header <code class="prettyprint">Content-Encoding</code>).</p>

<p>No exemplo ao lado, a requisi√ß√£o sem compress√£o possui um tamanho de 604 bytes. Quando comprimida, possui um tamanho de 290 bytes.</p>

          <h1 id="autentica„ß„£o">Autentica√ß√£o</h1>

<blockquote>
<p>Exemplo de chamada API autenticada (onde 7ezUPAqq8T1ny0w1bSXr √© o authentication_token do usu√°rio):</p>
</blockquote>
<pre class="highlight shell"><code><span class="gp">$ </span>curl -u 7ezUPAqq8T1ny0w1bSXr <span class="se">\</span>
       -H <span class="s2">"Accept: application/xml"</span> <span class="se">\</span>
       -H <span class="s2">"Content-type: application/xml"</span> <span class="se">\</span>
       -X GET https://app.myfinance.com.br/people/816
</code></pre>

<p>Todo acesso √† API √© feito do ponto de vista de um usu√°rio existente no MyFinance.</p>

<p>Sendo assim, toda requisi√ß√£o √† API dever√° ser autenticada via HTTP Basic utilizando um token de acesso.</p>

<p>No entant, em vez de utilizar o login e senha do usu√°rio, como √© tradicional, deve-se fornecer o <code class="prettyprint">authentication_token</code> do usu√°rio (uma string de at√© 60 caracteres encontrada na p√°gina de perfil do usu√°rio no Passaporte Web) no campo &lsquo;login&rsquo; e uma string vazia no campo &#39;password&rsquo;.</p>

<p>Alguns clientes HTTP podem reclamar do fato do campo &#39;password&rsquo; estar vazio, nesse caso pode-se informar &#39;X&rsquo; como senha que o sistema ir√° ignorar.</p>

<aside class="notice">
Lembre-se de substituir <code>7ezUPAqq8T1ny0w1bSXr</code> pelo seu <code>authentication_token</code>.
</aside>

          <h2 id="m„∫ltiplas-contas">M√∫ltiplas contas</h2>

<blockquote>
<p>Exemplo de utiliza√ß√£o com m√∫ltiplas contas</p>
</blockquote>
<pre class="highlight shell"><code><span class="gp">$ </span>curl -u 7ezUPAqq8T1ny0w1bSXr <span class="se">\</span>
       -H <span class="s2">"Accept: application/xml"</span> <span class="se">\</span>
       -H <span class="s2">"Content-type: application/xml"</span> <span class="se">\</span>
       -H <span class="s2">"ACCOUNT_ID: 1"</span> <span class="se">\</span>
       -X GET http://app.myfinance.com.br/people/816
</code></pre>

<h3 id="tenho-mais-de-uma-conta-como-devo-proceder">Tenho mais de uma conta, como devo proceder?</h3>

<p>Caso voc√™ possua acesso a v√°rias contas, ser√° necess√°rio informar o ID da conta que deseja utilizar.</p>

<p>Isto √© feito atrav√©s do <code class="prettyprint">header</code> <code class="prettyprint">ACCOUNT_ID</code> enviado no cabe√ßalho da requisi√ß√£o.</p>

          <h2 id="erros-na-autentica„ß„£o">Erros na autentica√ß√£o</h2>

<h3 id="authentication_token-inv„°lido"><code class="prettyprint">authentication_token</code> inv√°lido</h3>

<blockquote>
<p>Exemplo de requisi√ß√£o sem informa√ß√µes de autentica√ß√£o</p>
</blockquote>
<pre class="highlight shell"><code><span class="gp">$ </span>curl -H <span class="s2">"Accept: application/xml"</span> <span class="se">\</span>
       -H <span class="s2">"Content-type: application/xml"</span> <span class="se">\</span>
       -X GET -https://app.myfinance.com.br/people/816

</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unauthenticated"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>
<pre class="highlight xml"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;errors&gt;</span>
  <span class="nt">&lt;error&gt;</span>unauthenticated<span class="nt">&lt;/error&gt;</span>
<span class="nt">&lt;/errors&gt;</span>
</code></pre>

<p>Caso o usu√°rio deixe de informar um <code class="prettyprint">authentication_token</code> ou este seja inv√°lido, o sistema retornar√° um erro <code class="prettyprint">401: Unauthorized</code></p>

<h3 id="erro-ao-n„£o-informar-o-header-account_id">Erro ao n√£o informar o <code class="prettyprint">header</code> <code class="prettyprint">ACCOUNT_ID</code></h3>

<blockquote>
<p>Exemplo de resposta com erro ao n√£o informar o <code class="prettyprint">header</code> <code class="prettyprint">ACCOUNT_ID</code></p>
</blockquote>
<pre class="highlight shell"><code><span class="gp">$ </span>curl -u 7ezUPAqq8T1ny0w1bSXr <span class="se">\</span>
       -H <span class="s2">"Accept: application/xml"</span> <span class="se">\</span>
       -H <span class="s2">"Content-type: application/xml"</span> <span class="se">\</span>
       -X GET http://app.myfinance.com.br/people/816
</code></pre>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"O cabe√ßalho da requisi√ß√£o n√£o possui o atributo ACCOUNT_ID"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unprocessable_entity"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"accounts"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nt">"account"</span><span class="p">:{</span><span class="nt">"id"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"Conta Um"</span><span class="p">}},{</span><span class="nt">"account"</span><span class="p">:{</span><span class="nt">"id"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"Conta 2"</span><span class="p">}}]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<pre class="highlight xml"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;errors&gt;</span>
  <span class="nt">&lt;error&gt;</span>O cabe√ßalho da requisi√ß√£o n√£o possui o atributo ACCOUNT_ID<span class="nt">&lt;/error&gt;</span>
  <span class="nt">&lt;status&gt;</span>unprocessable_entity<span class="nt">&lt;/status&gt;</span>
  <span class="nt">&lt;accounts</span> <span class="na">type=</span><span class="s">"array"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;account&gt;</span>
      <span class="nt">&lt;id</span> <span class="na">type=</span><span class="s">"integer"</span><span class="nt">&gt;</span>1<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;name&gt;</span>Conta Um<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;/account&gt;</span>
    <span class="nt">&lt;account&gt;</span>
      <span class="nt">&lt;id</span> <span class="na">type=</span><span class="s">"integer"</span><span class="nt">&gt;</span>2<span class="nt">&lt;/id&gt;</span>
      <span class="nt">&lt;name&gt;</span>Conta Dois<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;/account&gt;</span>
  <span class="nt">&lt;/accounts&gt;</span>
<span class="nt">&lt;/errors&gt;</span>
</code></pre>

<p>Se o <code class="prettyprint">header</code> <code class="prettyprint">ACCOUNT_ID</code> n√£o for informado ou o valor informado n√£o estiver associado ao <code class="prettyprint">authentication_token</code> utilizado,
o sistema retornar√° uma mesagem de erro <code class="prettyprint">422: Unprocessable Entity</code>.</p>

          <h2 id="autoriza„ß„£o-de-uso-da-api">Autoriza√ß√£o de uso da API</h2>

<blockquote>
<p>Exemplo de resposta com erro por n√£o estar autorizado a acessar a API</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Seu plano n√£o permite o uso da API."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<pre class="highlight xml"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;errors&gt;</span>
  <span class="nt">&lt;error&gt;</span>Seu plano n√£o permite o uso da API.<span class="nt">&lt;/error&gt;</span>
<span class="nt">&lt;/errors&gt;</span>
</code></pre>

<p>Apenas usu√°rios de contas em planos Plus ou superior t√™m acesso autorizado √† API.
Caso o acesso √† API seja feito utilizando um <code class="prettyprint">authentication_token</code> de um usu√°rio cujo plano n√£o permite acesso √† API, uma resposta de erro <code class="prettyprint">403: Forbidden</code> ser√° retornada.</p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="json">json</a>
                <a href="#" data-language-name="xml">xml</a>
          </div>
      </div>
    </div>
  </body>
</html>
